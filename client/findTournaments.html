<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>Map view</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.51.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.51.0/mapbox-gl.css' rel='stylesheet' />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="styles/main.css">
    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
    </style>
</head>
<body>
<body ng-app="directoryApp" style="padding-top: 70px">

    <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top" ng-controller="UserController">
      <a class="navbar-brand"> <font color="orange">GT</font><font color= "blue">ourney</font> </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link active" href="/home">Home<span class="sr-only"></span></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" ng-init="getLoggedInUser()" href="/map">Find Tournaments</a>
        </li>
        <li class="nav-item" ng-if="loggedInUser != undefined">
          <a class="nav-link" href="/profile">Profile</a>
        </li>
        <li class="nav-item" ng-if="loggedInUser != undefined">
          <a class="nav-link" href="/logout">Logout<span class="sr-only"></span></a>
        </li>
        <li class="nav-item" ng-if="loggedInUser == undefined">
          <a class="nav-link" href="/login">Login<span class="sr-only"></span></a>
        </li>
        <li class="nav-item" ng-if="loggedInUser != undefined">
          <a class="nav-link" href="/create">Create Event<span class="sr-only"></span></a>
        </li>
        <li class="nav-item" ng-if="loggedInUser != undefined">
          <a class="nav-link" href="/admin" ng-if="loggedInUser.admin == true">Admin Page<span class="sr-only"></span></a>
        </li>
      </ul>
    </div>
    </nav>
<div id='map'></div>
<script src='https://unpkg.com/es6-promise@4.2.4/dist/es6-promise.auto.min.js'></script>
<script src="https://unpkg.com/@mapbox/mapbox-sdk/umd/mapbox-sdk.min.js"></script>
<script>
mapboxgl.accessToken = 'pk.eyJ1Ijoid2VpbGluMTIyMSIsImEiOiJjanAzZHA3a3IwZ3NzM3NxcmxuazNvb2ZyIn0.M-0ttKHcot2nJ65rbu6p7w';
// eslint-disable-next-line no-undef
var mapboxClient = mapboxSdk({ accessToken: mapboxgl.accessToken });
var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/streets-v9',
    center: [-82.325020, 29.651979],
    zoom: 12
});
</script>
<div class="container" ng-controller="TourneyController">
<div class="info" ng-repeat="x in tourneys | orderBy: 'tournamentName':true">
			<div class="card-body">
				<h5 class="Game">Game: {{x.game}}
				<h5 class="Date">Date: {{displayDate(x)}}
				<p class="Address">{{x.address}}
				<p class="Details">Details: {{x.details}}
	
<script>
var a = new mapboxgl.Popup({ offset: 25 })
    .setText('what');
mapboxClient.geocoding.forwardGeocode({
    query: '2330 sw williston rd, gainesville, fl',
    autocomplete: false,
    limit: 1
})
    .send()
    .then(function (response) {
        if (response && response.body && response.body.features && response.body.features.length) {
            feature = response.body.features[0];
            new mapboxgl.Marker()
                .setLngLat(feature.center)
                .setPopup(a)
                .addTo(map);
        }
    });

var address = document.getElementsByClassName('Address')[0].textContent;
var des = "Address: " + address;
var b = new mapboxgl.Popup({ offset: 25 })
    .setText(des);
mapboxClient.geocoding.forwardGeocode({
    query: '2601 sw archer rd, gainesville, fl',
    autocomplete: false,
    limit: 1
})
    .send()
    .then(function (response) {
        if (response && response.body && response.body.features && response.body.features.length) {
            feature = response.body.features[0];
            new mapboxgl.Marker()
                .setLngLat(feature.center)
                .setPopup(b)
                .addTo(map);
        }
    });
</script>
</h5>
</h5>
</p>
</p>
			</div>
		</div>
		<hr>
	</div>
    <!-- Scripts I've added-->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <!-- Scripts that were already there before minus redundancies -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <!-- What are these for? -->
    <script src="https://code.angularjs.org/1.4.3/angular.js"></script>
    <script src="https://code.angularjs.org/1.4.3/angular-cookies.js"></script>
    <script src="js/app.js"></script>
    <script src="js/factories/tourneyFactory.js"></script>
    <script src="js/controllers/tourneyController.js"></script>
    <script src="js/factories/userFactory.js"></script>
  <script src="js/controllers/userController.js"></script>


</body>
</html>